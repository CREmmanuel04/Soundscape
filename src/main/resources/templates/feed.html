<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Feed</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <style>
        body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background: #f5f8fa; margin: 0; }
        .nav { background: #1d9bf0; color: white; padding: 12px 16px; font-weight: 600; }
        .container { max-width: 680px; margin: 0 auto; padding: 16px; }
        .composer { background: #fff; border: 1px solid #e1e8ed; border-radius: 8px; padding: 12px; margin-bottom: 16px; }
        textarea { width: 100%; min-height: 80px; border: 1px solid #e1e8ed; border-radius: 6px; padding: 8px; font-size: 14px; resize: vertical; }
        .actions { display: flex; justify-content: space-between; align-items: center; margin-top: 8px; }
        .count { color: #657786; font-size: 12px; }
        button { background: #1d9bf0; color: white; border: none; border-radius: 999px; padding: 8px 14px; font-weight: 600; cursor: pointer; }
        button:disabled { background: #9ecff5; cursor: not-allowed; }
        .feed { display: grid; gap: 12px; }
        .post { background: #fff; border: 1px solid #e1e8ed; border-radius: 8px; padding: 12px; }
        .meta { color: #657786; font-size: 12px; margin-bottom: 6px; }
        .content { white-space: pre-wrap; font-size: 14px; }
        .topbar { display: flex; justify-content: space-between; align-items: center; }
        .logout { color: white; text-decoration: none; font-weight: 500; }
    </style>
</head>
<body>
<div class="nav">
    <div class="topbar">
        <div>Mini Twitter</div>
        <a class="logout" th:href="@{/logout}">Logout</a>
    </div>
</div>

<div class="container">
    <div class="composer">
        <form th:action="@{/posts}" method="post" th:object="${postForm}">
            <textarea id="content" th:field="*{content}" maxlength="280" placeholder="What's happening?" required></textarea>
            <div class="actions">
                <span id="charCount" class="count">280 chars left</span>
                <button type="submit">Post</button>
            </div>
        </form>
    </div>

    <div class="feed">
        <div th:each="p : ${posts}" class="post">
            <div class="meta">
                <span th:text="${p.author}">author</span>
                &middot;
                <span th:text="${#temporals.format(p.createdAt, 'yyyy-MM-dd HH:mm')}">time</span>
            </div>
            <div class="content" th:text="${p.content}">content</div>
        </div>
    </div>
</div>

<script>
    (function () {
        var ta = document.getElementById('content');
        var cc = document.getElementById('charCount');
        function update() {
            var remaining = 280 - (ta.value ? ta.value.length : 0);
            cc.textContent = remaining + ' chars left';
        }
        ta.addEventListener('input', update);
        update();
    })();
</script>
</body>
</html>